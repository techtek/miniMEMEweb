<!doctype html>
<html lang="en">

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-93FM5LCQCW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-93FM5LCQCW');
</script>

<head>
  <meta charset="utf-8">
  <title>miniMEME</title>
</head>
<body class="fullscreen">
  <div class="background-slideshow"></div>
  <div class="background-overlay"></div>

  <div class="container">
  </div>
  <script src="js/main.js"></script>

  <style>
    body {
        margin: 0;
        padding: 0;
        background-color: black;
        zoom: 1.8;
        -moz-transform: scale(1.8);
        -moz-transform-origin: 0 0;
        font: 1.3rem Inconsolata, monospace;
        text-align: center;
        color: #3f3f3f;
    }

    html, body {
        height: 100%;
        background-color: #00000;
    }

    html {
        display: table;
        margin: auto;
    }

    body {
        display: table-cell;
    }

    #container {
        position: relative;
        width: 100%;
        max-width: 400px;
        height: auto;
    }

    #background-image {
        width: 400px;
        height: auto;
        display: block;
        border: 0px solid #0DFF00;
        border-radius: 0px;
    }

    .background-slideshow {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-size: cover;
        background-position: center;
        filter: blur(8px);
        z-index: -2;
    }

    .background-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.4);
        z-index: -1;
    }

    .container {
        position: relative;
        z-index: 1;
    }
  </style>

  <div id="container">
      <img src="backgroundblack.png" style="margin-top: 70px;" id="background-image">

      <!-- Slideshow container -->
      <div id="slideshow-container"></div>
  </div>

  <script>
    const apiURL = "https://sunpump.meme/";

    async function fetchSunpumpImages() {
        try {
            const response = await fetch(apiURL);
            const text = await response.text();
            const parser = new DOMParser();
            const doc = parser.parseFromString(text, 'text/html');

            // Select the last 4 images based on the specific class
            const images = Array.from(doc.querySelectorAll('img[class*="_cover_"]')).map(img => img.src);
            return images.slice(-4); // Get the last 4 images
        } catch (error) {
            console.error('Error fetching images:', error);
            return [];
        }
    }

    async function startSlideshow() {
        const background = document.querySelector('.background-slideshow');
        const slideshowContainer = document.getElementById("slideshow-container");

        const images = await fetchSunpumpImages();
        if (images.length === 0) {
            console.error('No images found for the slideshow.');
            return;
        }

        let backgroundImageIndex = 0;
        let slideshowIndex = 0;

        function showNextSlide() {
            // Update the background image
            background.style.backgroundImage = `url(${images[backgroundImageIndex]})`;

            // Create a new img element for the slideshow
            const img = document.createElement("img");
            img.src = images[slideshowIndex];
            img.style.opacity = 0; // Start as invisible
            slideshowContainer.innerHTML = ""; // Clear previous image
            slideshowContainer.appendChild(img);

            // Fade-in effect for the new image
            setTimeout(() => {
                img.style.opacity = 1;
            }, 10);

            // Update indexes
            backgroundImageIndex = (backgroundImageIndex + 1) % images.length;
            slideshowIndex = (slideshowIndex + 1) % images.length;
        }

        // Show the first slide immediately
        showNextSlide();

        // Change images every 6 seconds
        setInterval(showNextSlide, 6000);
    }

    document.addEventListener('DOMContentLoaded', () => {
        startSlideshow();
    });
  </script>
</body>
</html>
